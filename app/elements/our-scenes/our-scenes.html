<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../../bower_components/core-selector/core-selector.html">
<link rel="import" href="../../bower_components/core-item/core-item.html">
<link rel="import" href="../../bower_components/core-icon-button/core-icon-button.html">
<link rel="import" href="../../bower_components/core-icon/core-icon.html">
<link rel="import" href="../../elements/our-quizcard/our-quizcard.html">
<link rel="import" href="../../elements/our-quiz/our-quiz.html">
<link rel="import" href="../../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/slide-from-right.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/cross-fade.html">
<link rel="import" href="../../bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="../../elements/our-quizmaker/our-quizmaker.html">





<polymer-element name="our-scenes" attributes="">
<template>
  <core-ajax url="https://quistar.firebaseio.com/.json" handleAs="json" id="getAjax" on-core-response="{{handleResponse}}" auto></core-ajax>
  <link rel="stylesheet" href="our-scenes.css">
  <core-animated-pages fit selected="" id="scenes" transitions="slide-from-right" vertical layout center>
  
  <section vertical layout center>
    <!-- <div id="logo-quispel" src=""></div> -->
    <core-header-panel fit mode="waterfall">
    <div class="core-header" vertical layout center>
      <h1>QUIST<img class="ster" src="../../images/STER.svg" on-tap="{{editor}}"></img>R</h1>
    </div>
    <div>
    <core-selector id="quizSelector" valueattr="quizId" on-core-activate="{{selectQuiz}}" fit>
  
    <template repeat="{{ quiz, i in quizzes }}">
      <our-quizcard quizTitel="{{ quiz.quiztitel }}" quizDescr="{{ quiz.quizdescr }}" quizId="{{i}}"></our-quizcard>
    </template>
  </core-selector>
  </div>
  </div>

</section>
<section vertical layout center fit>
  <our-quiz quizObject="{{quizObject}}" quizId="{{quizSelected}}" id="ourquiz"></our-quiz>
</section>

<section vertical layout center>
    <our-quizmaker fit id="quizmaker"></our-quizmaker>
  </section>
</core-animated-pages>
</template>
<script>
  (function () {
    'use strict';

    Polymer({

        ready: function(){
           this.$.scenes.selected = 0;
           var that = this;
           this.$.ourquiz.addEventListener('overzicht', function(){
              that.$.scenes.selected = 0;
           });
           this.$.quizmaker.addEventListener('exit', function(){
              that.$.scenes.selected = 0;
           });
           this.$.quizSelector.addEventListener('startquiz', function(){
            that.selectQuiz();
           });
        },

        // define element prototype here
        handleResponse: function(e){
          this.quizzes = e.detail.response;
        },

        editor: function(){
          this.$.scenes.selected = 2;
        },

        selectQuiz: function(){
          this.quizSelected = this.$.quizSelector.selectedItem.quizId;
          this.quizObject = this.quizzes[this.quizSelected];
          this.$.scenes.selected = 1;
        }
      });

  })();
</script>
</polymer-element>
