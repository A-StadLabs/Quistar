<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../bower_components/core-icon-button/core-icon-button.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../../bower_components/paper-radio-button/paper-radio-button.html">
<link rel="import" href="../../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../../bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../../bower_components/core-selector/core-selector.html">
<link rel="import" href="../../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/slide-from-right.html">
<link rel="import" href="../../elements/file-upload/file-upload.html">
<link rel="import" href="../../bower_components/google-signin/google-signin.html">



<polymer-element name="our-quizmaker" attributes="username">
  <template>
    <link rel="stylesheet" href="our-quizmaker.css">
    
    <core-header-panel fit>
      <core-toolbar>
        <core-icon-button icon="close" on-tap="{{exit}}"></core-icon-button>
      </core-toolbar>
      <core-animated-pages id="animated" transitions="slide-from-right" fit>
        <section>
        <div class="card">
          <div class="container">
            <h1>Maak zelf een Quistar</h1>
            <p>Meld je eerst aan met een google account. Zo weten de spelers wie de Quistar heeft gemaakt.</p>
            <google-signin width="iconOnly" clientId="719285224024-av2evld3lehrtsh3ef0eki055paumcpr.apps.googleusercontent.com" scopes="profile" id="gsign"></google-signin>
          </div>
        </div>
        </section>
        <section>
        <div class="card">
          <div class="container">
            <h1>Maak zelf een Quistar</h1>
            <p>Een Quistar quiz heeft altijd 7 vragen met 3 antwoorden per vraag.</p>
            <template id="profile" bind="{{ profile }}">
              <p class="small">Je bent aangemeld als {{displayName}}.</p>
            </template>
            <paper-input label="Naam van Quiz" id="quizNaam"></paper-input>
            <paper-input label="Korte beschrijving" id="quizDescr" multiline></paper-input>
            <p>Zichtbaar in overzicht?  <paper-toggle-button id="publicQuiz"></paper-toggle-button></p>
          </div>
        </div>

        <div class="card">
          <div class="container">
            <h1>Opdracht 1</h1>
            <paper-input label="Wat is de vraag?" id="quizVraag1"></paper-input>
            <file-upload imgval="{{showme1}}" id="img1"></file-upload>
            <img src="{{showme1}}" width="50">
            <paper-input label="Antwoord 1" id="opdracht1antwoord1"></paper-input>
            <paper-input label="Antwoord 2" id="opdracht1antwoord2"></paper-input>
            <paper-input label="Antwoord 3" id="opdracht1antwoord3"></paper-input>
            <p>Het juiste antwoord is:</p>
            <paper-radio-group id="juiste1">
              <paper-radio-button value="" label="Antwoord 1" id="opdracht1juiste1"></paper-radio-button>
              <paper-radio-button value="" label="Antwoord 2" id="opdracht1juiste2"></paper-radio-button>
              <paper-radio-button value="" label="Antwoord 3" id="opdracht1juiste3"></paper-radio-button>
            </paper-radio-group>
          </div>
        </div>

        <div class="card">
          <div class="container">
            <h1>Opdracht 2</h1>
            <paper-input label="Wat is de vraag?" id="quizVraag2"></paper-input>
            <file-upload imgval="{{showme2}}" id="img2"></file-upload>
            <img src="{{showme2}}" width="50">
            <paper-input label="Antwoord 1" id="opdracht2antwoord1"></paper-input>
            <paper-input label="Antwoord 2" id="opdracht2antwoord2"></paper-input>
            <paper-input label="Antwoord 3" id="opdracht2antwoord3"></paper-input>
            <p>Het juiste antwoord is:</p>
            <paper-radio-group id="juiste2">
              <paper-radio-button value="" label="Antwoord 1" id="opdracht2juiste1"></paper-radio-button>
              <paper-radio-button value="" label="Antwoord 2" id="opdracht2juiste2"></paper-radio-button>
              <paper-radio-button value="" label="Antwoord 3" id="opdracht2juiste3"></paper-radio-button>
            </paper-radio-group>
          </div>
        </div>

        <div class="card">
          <div class="container">
            <h1>Opdracht 3</h1>
            <paper-input label="Wat is de vraag?" id="quizVraag3"></paper-input>
            <file-upload imgval="{{showme3}}" id="img3"></file-upload>
            <img src="{{showme3}}" width="50">
            <paper-input label="Antwoord 1" id="opdracht3antwoord1"></paper-input>
            <paper-input label="Antwoord 2" id="opdracht3antwoord2"></paper-input>
            <paper-input label="Antwoord 3" id="opdracht3antwoord3"></paper-input>
            <p>Het juiste antwoord is:</p>
            <paper-radio-group id="juiste3">
              <paper-radio-button value="" label="Antwoord 1" id="opdracht3juiste1"></paper-radio-button>
              <paper-radio-button value="" label="Antwoord 2" id="opdracht3juiste2"></paper-radio-button>
              <paper-radio-button value="" label="Antwoord 3" id="opdracht3juiste3"></paper-radio-button>
            </paper-radio-group>
          </div>
        </div>

        <div class="card">
          <div class="container">
            <h1>Opdracht 4</h1>
            <paper-input label="Wat is de vraag?" id="quizVraag4"></paper-input>
            <file-upload imgval="{{showme4}}" id="img4"></file-upload>
            <img src="{{showme4}}" width="50">
            <paper-input label="Antwoord 1" id="opdracht4antwoord1"></paper-input>
            <paper-input label="Antwoord 2" id="opdracht4antwoord2"></paper-input>
            <paper-input label="Antwoord 3" id="opdracht4antwoord3"></paper-input>
            <p>Het juiste antwoord is:</p>
            <paper-radio-group id="juiste4">
              <paper-radio-button value="" label="Antwoord 1" id="opdracht4juiste1"></paper-radio-button>
              <paper-radio-button value="" label="Antwoord 2" id="opdracht4juiste2"></paper-radio-button>
              <paper-radio-button value="" label="Antwoord 3" id="opdracht4juiste3"></paper-radio-button>
            </paper-radio-group>
          </div>
        </div>

        <div class="card">
          <div class="container">
            <h1>Opdracht 5</h1>
            <paper-input label="Wat is de vraag?" id="quizVraag5"></paper-input>
            <file-upload imgval="{{showme5}}" id="img5"></file-upload>
            <img src="{{showme5}}" width="50">
            <paper-input label="Antwoord 1" id="opdracht5antwoord1"></paper-input>
            <paper-input label="Antwoord 2" id="opdracht5antwoord2"></paper-input>
            <paper-input label="Antwoord 3" id="opdracht5antwoord3"></paper-input>
            <p>Het juiste antwoord is:</p>
            <paper-radio-group id="juiste5">
              <paper-radio-button value="" label="Antwoord 1" id="opdracht5juiste1"></paper-radio-button>
              <paper-radio-button value="" label="Antwoord 2" id="opdracht5juiste2"></paper-radio-button>
              <paper-radio-button value="" label="Antwoord 3" id="opdracht5juiste3"></paper-radio-button>
            </paper-radio-group>
          </div>
        </div>

        <div class="card">
          <div class="container">
            <h1>Opdracht 6</h1>
            <paper-input label="Wat is de vraag?" id="quizVraag6"></paper-input>
            <file-upload imgval="{{showme6}}" id="img6"></file-upload>
            <img src="{{showme6}}" width="50">
            <paper-input label="Antwoord 1" id="opdracht6antwoord1"></paper-input>
            <paper-input label="Antwoord 2" id="opdracht6antwoord2"></paper-input>
            <paper-input label="Antwoord 3" id="opdracht6antwoord3"></paper-input>
            <p>Het juiste antwoord is:</p>
            <paper-radio-group id="juiste6">
              <paper-radio-button value="" label="Antwoord 1" id="opdracht6juiste1"></paper-radio-button>
              <paper-radio-button value="" label="Antwoord 2" id="opdracht6juiste2"></paper-radio-button>
              <paper-radio-button value="" label="Antwoord 3" id="opdracht6juiste3"></paper-radio-button>
            </paper-radio-group>
          </div>
        </div>

        <div class="card">
          <div class="container">
            <h1>Opdracht 7</h1>
            <paper-input label="Wat is de vraag?" id="quizVraag7"></paper-input>
            <file-upload imgval="{{showme7}}" id="img7"></file-upload>
            <img src="{{showme7}}" width="50">
            <paper-input label="Antwoord 1" id="opdracht7antwoord1"></paper-input>
            <paper-input label="Antwoord 2" id="opdracht7antwoord2"></paper-input>
            <paper-input label="Antwoord 3" id="opdracht7antwoord3"></paper-input>
            <p>Het juiste antwoord is:</p>
            <paper-radio-group id="juiste7">
              <paper-radio-button value="" label="Antwoord 1" id="opdracht7juiste1"></paper-radio-button>
              <paper-radio-button value="" label="Antwoord 2" id="opdracht7juiste2"></paper-radio-button>
              <paper-radio-button value="" label="Antwoord 3" id="opdracht7juiste3"></paper-radio-button>
            </paper-radio-group>
          </div>
        </div>

        <div class="card">
          <div class="container">
            <h1>Publiceer deze Quistar</h1>
            <p>Kijk alles nog eens goed na en druk op <i>publiceren</i></p>
            <core-icon-button on-tap="{{saveQuiz}}" icon="arrow-forward">Publiceren</core-icon-button>
          </div>
        </div>

        </section>

        <section>
            <div class="card">
          <div class="container">
            <h1>Jouw Quistar is klaar.</h1>
            <p>Je vindt jouw Quistar terug op deze url:</p>
            <input flex value="https://quistar.firebaseapp.com/#/quiz/{{quizName}}/" onClick="this.select();" class="URLfield">
            <a href="https://quistar.firebaseapp.com/#/quiz/{{quizName}}/">https://quistar.firebaseapp.com/#/quiz/{{quizName}}/</a>
            <p>Vragen? @astadlabs</p>
          </div>
        </div>
        </section>

      </core-animated-pages>

    </core-header-panel>
    <core-ajax method="POST" id="quizPost" handleAs="json" data url="https://quistar.firebaseio.com/.json" on-core-response="{{ajaxResponse}}">
  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        ready: function(){
          this.userobject = {};

          var that = this;

          this.addEventListener('google-signin-success', function(e){
            gapi.client.load('plus', 'v1', function() {
            // To retreive profile information for a user, use the
            // people.get API method. For profile info for the currently
            // authorized user, use the userId value of me.
            var request = gapi.client.plus.people.get({
                'userId': 'me'
            });

            request.execute(function(resp) {
                // Some useful profile information is now available
                // via the returned object (resp). For example, we
                // can discover the displayName, skills and so on.
                //console.log(resp);

                // This data can then be rendered into a template:
                var t = that.$.profile;
                t.model = {};
                t.model.profile = resp;

                that.userobject = resp;
                that.$.animated.selected = 1;
            });
        });
          });

          this.nieuwequiz = [];
          //console.log('----- quizobject: ', JSON.stringify(this.nieuwequiz));
        },

        saveQuiz: function(){
          var that = this;
          console.log('juist1: ',that.$.juiste1.selected);
         
          console.log('check answers: ',that.$.quizNaam.value);

          

          this.opgaven = [];

          this.opgaven.push({
            'vraag': that.$.quizVraag1.value, 
            'img': that.$.img1.imgval,
            'juiste': that.$.juiste1.selected+1,
            'antwoorden': {
              'antwoord1': that.$.opdracht1antwoord1.value,
              'antwoord2': that.$.opdracht1antwoord2.value,
              'antwoord3': that.$.opdracht1antwoord3.value
            }
          });
          
          this.opgaven.push({  
            'vraag': that.$.quizVraag2.value, 
            'img': that.$.img2.imgval,
            'juiste': that.$.juiste2.selected+1,
            'antwoorden': {
              'antwoord1': that.$.opdracht2antwoord1.value,
              'antwoord2': that.$.opdracht2antwoord2.value,
              'antwoord3': that.$.opdracht2antwoord3.value
            }
          });
          
          this.opgaven.push({  
            'vraag': that.$.quizVraag3.value, 
            'img': that.$.img3.imgval,
            'juiste': that.$.juiste3.selected+1,
            'antwoorden': {
              'antwoord1': that.$.opdracht3antwoord1.value,
              'antwoord2': that.$.opdracht3antwoord2.value,
              'antwoord3': that.$.opdracht3antwoord3.value
            }
          });
          
          this.opgaven.push({  
            'vraag': that.$.quizVraag4.value, 
            'img': that.$.img4.imgval,
            'juiste': that.$.juiste4.selected+1,
            'antwoorden': {
              'antwoord1': that.$.opdracht4antwoord1.value,
              'antwoord2': that.$.opdracht4antwoord2.value,
              'antwoord3': that.$.opdracht4antwoord3.value
            }
          });
          
          this.opgaven.push({  
            'vraag': that.$.quizVraag5.value, 
            'img': that.$.img5.imgval,
            'juiste': that.$.juiste5.selected+1,
            'antwoorden': {
              'antwoord1': that.$.opdracht5antwoord1.value,
              'antwoord2': that.$.opdracht5antwoord2.value,
              'antwoord3': that.$.opdracht5antwoord3.value
            }
          });
          
          this.opgaven.push({  
            'vraag': that.$.quizVraag6.value, 
            'img': that.$.img6.imgval,
            'juiste': that.$.juiste6.selected+1,
            'antwoorden': {
              'antwoord1': that.$.opdracht6antwoord1.value,
              'antwoord2': that.$.opdracht6antwoord2.value,
              'antwoord3': that.$.opdracht6antwoord3.value
            }
          });
          
          this.opgaven.push({  
            'vraag': that.$.quizVraag7.value, 
            'img': that.$.img7.imgval,
            'juiste': that.$.juiste7.selected+1,
            'antwoorden': {
              'antwoord1': that.$.opdracht7antwoord1.value,
              'antwoord2': that.$.opdracht7antwoord2.value,
              'antwoord3': that.$.opdracht7antwoord3.value
            }
          });

          this.nieuwequiz.push({ 
            'quiztitel': that.$.quizNaam.value,
            'quizdescr': that.$.quizDescr.value,
            'published': that.$.publicQuiz.checked,
            'plays': 0,
            'ownernick': that.userobject.displayName,
            'owneravatar': that.userobject.image.url,
            'opgaven': this.opgaven
          });

          console.log('quizobject: ', JSON.stringify(this.nieuwequiz));
          //console.log('opgaven: ', JSON.stringify(this.opgaven));

          this.data = JSON.stringify(this.nieuwequiz);
          that.$.quizPost.body = this.data;

          console.log('Ik ga versturen: ',that.$.quizPost.body);

          that.$.quizPost.go();
          // this.opdrachten = [];
          // this.opdrachten[0].opdracht = that.$.quizVraag1.value;
          // this.opdrachten[0].antwoorden[0] = this.$.opdracht1antwoord1.value;
          // this.opdrachten[0].antwoorden[0].juist = 'false';
          // console.log('quizVraag1: ', JSON.stringify(this.opdrachten));
          that.$.animated.selected++;

        },
        // define element prototype here
        next: function(){
          this.$.animated.selected++;
        },

        exit: function(){
          this.$.animated.selected=0;
          this.fire('exit');
        },

        ajaxResponse: function(e){
          console.log('response: ',e.detail.response.name);
          this.quizName = e.detail.response.name;
        }
      });

    })();
  </script>
</polymer-element>
