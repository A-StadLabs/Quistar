<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-icon-button/core-icon-button.html">
<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../elements/our-leaderboard/our-leaderboard.html">
<link rel="import" href="../../elements/our-opgave/our-opgave.html">
<link rel="import" href="../../elements/our-countdown/our-countdown.html">
<link rel="import" href="../../elements/our-leaderentry/our-leaderentry.html">
<link rel="import" href="../../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../../bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/slide-from-right.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/cross-fade.html">

<polymer-element name="our-quiz" attributes="quizObject quizId">
  <template>
    <link rel="stylesheet" href="our-quiz.css">
    <core-animated-pages id="quizscenes" selected="0" fit transitions="slide-from-right">
    <section>
    <core-header-panel mode="waterfall" fit>
    <core-toolbar id="backbutton">
    <div  class="core-header" vertical layout>
      <div><core-icon-button icon="arrow-back" on-tap="{{quizOverzicht}}"></core-icon-button>
      </div>
      <div flex class="heading">
        
      </div>
    </div>
    <div flex horizontal center-justified layout></div>
    </core-toolbar>

    <div class="card">
      <div class="quizcardcontainer">
      <h1>{{quizObject.quiztitel}}</h1>
      <p>{{quizObject.quizdescr}}</p>
      <core-icon-button icon="arrow-forward" on-tap="{{startQuiz}}" class="startbutton">START DE QUIZ</core-icon-button>
      </div>

    </div>

    <div>
    <our-leaderboard quizobject="{{quizObject.leaderboard}}" quizId="{{quizId}}"></our-leaderboard>
    </div>
    </core-header-panel>
    </section>

    <!-- Hier start de quiz -->

    <section>
    <core-header-panel mode="waterfall" fit>

    <core-toolbar id="controls">

<div vertical layout fit>
  <div horizontal layout stretch class="top-controls">
    <div flex><core-icon-button icon="arrow-back" on-tap="{{quizOverzicht}}"></core-icon-button></div>
    <div class="heading" end-justified>{{score}} </div>
  </div>

    <div self-center stretch>
    <our-countdown timer="100" id="countdown"></our-countdown>
    </div>

</div>
    </core-toolbar>

    <div vertical layout>
    <our-opgave vragen="{{quizObject.opgaven}}" id="ouropgave"></our-opgave>
    </div>

    </core-header-panel>
    </section>

    <section>

          <core-toolbar id="backbutton">
    <div  class="core-header" vertical layout>
      <div><core-icon-button icon="arrow-back" on-tap="{{quizOverzicht}}">NAAR QUISTAR-MENU</core-icon-button>
      </div>
      <div flex class="heading">
        
      </div>
    </div>
    <div flex horizontal center-justified layout></div>
    </core-toolbar>
    <div class="card2">

    <h2>Jouw score is </h2>
    <h1 class="scoretag">{{score}}</h1>
    
    <p>Jouw A-profiel op de wall of fame</p>
    <our-leaderentry id="leaderentry" score="{{score}}" quizobject="{{quizObject}}" quizId="{{quizId}}"></our-leaderentry>

    </div>

    <our-leaderboard quizobject="{{quizObject.leaderboard}}" quizId="{{quizId}}"></our-leaderboard>
    </section>
    </core-animated-pages>
  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        publish: {
          quizObject: {
            value: true,
            reflect: true
          }
        },
        // define element prototype here
        ready: function(){
          //this.$.quizscenes.selected = 2;
          this.score = 0;
          this.tijd = 1000;

          var that = this;

          this.$.ouropgave.addEventListener('addscore', function(e){
            if(e.detail.antwoordis=='true'){
            that.score = that.score+that.$.countdown.timer/10;
            that.score = Math.round(that.score);


          } 
          that.$.countdown.timer = 1000;
          });

          this.$.ouropgave.addEventListener('einde', function(){
            that.$.quizscenes.selected++;
          });
        },
        startQuiz: function(){
          this.score = 0;
          this.$.leaderentry.hidden = false;
          this.$.quizscenes.selected = 1;
          this.$.countdown.timer = 1000;
          this.$.countdown.start = true;
        },

        quizOverzicht: function(){
          this.fire('overzicht');
          this.$.quizscenes.selected = 0;
        },

        quizObjectChanged: function(){
        }
      });

    })();
  </script>
</polymer-element>
