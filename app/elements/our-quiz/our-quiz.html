<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-icon-button/core-icon-button.html">
<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../elements/our-leaderboard/our-leaderboard.html">
<link rel="import" href="../../elements/our-opgave/our-opgave.html">
<link rel="import" href="../../elements/our-countdown/our-countdown.html">


<link rel="import" href="../../bower_components/core-animated-pages/core-animated-pages.html">

<polymer-element name="our-quiz" attributes="quizObject" vertical layout center center-justified>
  <template>
    <link rel="stylesheet" href="our-quiz.css">
    <core-animated-pages id="quizscenes" selected="0" fit>
    <section>
    <core-toolbar>
      <core-icon-button icon="arrow-back" on-tap="{{quizOverzicht}}">Terug naar quizoverzicht</core-icon-button>
    </core-toolbar>
    <h1>{{quizObject.quiztitel}}</h1>
    <p>{{quizObject.quizdescr}}</p>
    <core-icon-button icon="menu" on-tap="{{startQuiz}}">Start de quiz</core-icon-button>
    <our-leaderboard quizId="{{quizObject.quiztitel}}"></our-leaderboard>
    </section>

    <section>
    <core-toolbar id="controls">Score: {{score}} | Tijd: <our-countdown timer="0" id="countdown"></our-countdown>
    </core-toolbar>
    <our-opgave vragen="{{quizObject.opgaven}}" id="ouropgave"></our-opgave>
    </section>

    <section>
    <h1>Einde</h1>
    <h1>Jouw score is {{score}}</h1>
    <core-icon-button icon="account-circle" on-tap="{{saveScore}}" id="saveScoreButton">Bewaren?</core-icon-button>
    <p>Jouw A-profiel op de wall of fame</p>
    <core-icon-button icon="arrow-back" on-tap="{{quizOverzicht}}">Terug naar quizoverzicht</core-icon-button>
    <our-leaderboard quizId="{{quizObject.quiztitel}}"></our-leaderboard>
    </section>
    </core-animated-pages>
  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        publish: {
          quizObject: {
            value: true,
            reflect: true
          }
        },
        // define element prototype here
        ready: function(){
          this.score = 0;
          this.tijd = 10;
          var that = this;
          this.$.ouropgave.addEventListener('addscore', function(e){
            console.log('antwoord is: '+e.detail.antwoordis);
            if(e.detail.antwoordis=='true'){
            that.score = that.score+that.$.countdown.timer;
          } 
          that.$.countdown.timer = 10;
          });
          this.$.ouropgave.addEventListener('einde', function(){
            console.log('gedaan en score is: '+that.score);
            that.$.quizscenes.selected++;
          });
        },
        startQuiz: function(){
          this.score = 0;
          this.$.quizscenes.selected = 1;
          this.$.countdown.timer = 10;
          this.$.countdown.start = true;
        },

        quizOverzicht: function(){
          this.fire('overzicht');
          this.$.quizscenes.selected = 0;
        },
      });

    })();
  </script>
</polymer-element>
